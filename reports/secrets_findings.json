{
  "risky_patterns": [
    {
      "file": "src/config/production.config.ts",
      "line": 200,
      "pattern": "JWT_SECRET",
      "risk_level": "medium",
      "evidence": "JWT secret stored in environment variable",
      "recommendation": "Use external secret management"
    },
    {
      "file": "src/config/production.config.ts",
      "line": 209,
      "pattern": "ENCRYPTION_KEY",
      "risk_level": "high",
      "evidence": "Encryption key stored in environment variable",
      "recommendation": "Use external secret management with key rotation"
    },
    {
      "file": "src/config/production.config.ts",
      "line": 174,
      "pattern": "DB_PASSWORD",
      "risk_level": "high",
      "evidence": "Database password stored in environment variable",
      "recommendation": "Use external secret management"
    },
    {
      "file": "src/config/production.config.ts",
      "line": 271,
      "pattern": "AWS_ACCESS_KEY_ID",
      "risk_level": "high",
      "evidence": "AWS access key stored in environment variable",
      "recommendation": "Use IAM roles or external secret management"
    },
    {
      "file": "src/config/production.config.ts",
      "line": 272,
      "pattern": "AWS_SECRET_ACCESS_KEY",
      "risk_level": "high",
      "evidence": "AWS secret key stored in environment variable",
      "recommendation": "Use IAM roles or external secret management"
    },
    {
      "file": "src/config/production.config.ts",
      "line": 249,
      "pattern": "SENDGRID_API_KEY",
      "risk_level": "medium",
      "evidence": "SendGrid API key stored in environment variable",
      "recommendation": "Use external secret management"
    },
    {
      "file": "src/config/production.config.ts",
      "line": 265,
      "pattern": "TWILIO_AUTH_TOKEN",
      "risk_level": "medium",
      "evidence": "Twilio auth token stored in environment variable",
      "recommendation": "Use external secret management"
    }
  ],
  "secure_patterns": [
    {
      "file": "src/config/production.config.ts",
      "line": 218,
      "pattern": "bcrypt salt rounds",
      "security_level": "high",
      "evidence": "bcrypt with 12 salt rounds (recommended)",
      "status": "secure"
    },
    {
      "file": "src/utils/encryption.ts",
      "pattern": "encryption utilities",
      "security_level": "medium",
      "evidence": "Encryption utility implementation",
      "status": "secure"
    }
  ],
  "missing_implementations": [
    {
      "feature": "External secret management",
      "risk_level": "high",
      "recommendation": "Implement AWS Secrets Manager or HashiCorp Vault"
    },
    {
      "feature": "Key rotation",
      "risk_level": "high",
      "recommendation": "Implement automatic key rotation for encryption keys"
    },
    {
      "feature": "Secret scanning",
      "risk_level": "medium",
      "recommendation": "Implement secret scanning in CI/CD pipeline"
    },
    {
      "feature": "Database encryption at rest",
      "risk_level": "high",
      "recommendation": "Verify and implement database encryption at rest"
    }
  ]
}